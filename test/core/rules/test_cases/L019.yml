rule: L019

test_1:
  # Leading commas
  fail_str: |
    SELECT
      a
      , b
    FROM c
  fix_str: |
    SELECT
      a,
      b
    FROM c

  configs:
    rules:
      L019:
        comma_style: trailing

test_2:
  pass_str: |
    SELECT
      a
      , b
    FROM c

  configs:
    rules:
      L019:
        comma_style: leading

test_3:
  # Leading commas in with statement
  fail_str: |
    WITH cte_1 as (
        SELECT *
        FROM table_1
    )

    , cte_2 as (

        SELECT *
        FROM table_2
    )

    SELECT * FROM table_3
  fix_str: |
    WITH cte_1 as (
        SELECT *
        FROM table_1
    ),

    cte_2 as (

        SELECT *
        FROM table_2
    )

    SELECT * FROM table_3

  configs:
    rules:
      L019:
        comma_style: trailing

test_4:
  pass_str: |
    WITH cte_1 as (
        SELECT *
        FROM table_1
    )

    , cte_2 as (
        SELECT *
        FROM table_2
    )

    SELECT * FROM table_3

  configs:
    rules:
      L019:
        comma_style: leading

test_5:
  # Trailing commas
  fail_str: |
    SELECT
        a,
        b
        FROM c
  fix_str: |
    SELECT
        a
        , b
        FROM c

  configs:
    rules:
      L019:
        comma_style: leading

test_6:
  pass_str: |
    SELECT
        a,
        b
    FROM c

  configs:
    rules:
      L019:
        comma_style: trailing

trailing_comma_fixing_removes_extra_whitespace:
  fail_str: |
    SELECT
        field_1
        ,   field_2
        ,field_3,
        field_4,
        field_5
    FROM a
  fix_str: |
    SELECT
        field_1,
        field_2,
        field_3,
        field_4,
        field_5
    FROM a

  configs:
    rules:
      L019:
        comma_style: trailing

leading_comma_fixing_flows_around_comments:
  fail_str: |
    SELECT
        a.foo
        
        -- another comment
        , a.baz,
        -- another comment
         a.bar,
    
        -- This is an important comment with awkward line spacing
    
       a.foobar
    
        /* Which might also
        be followed by a multiline one */
        , a.barfoo
    FROM a
    WHERE
        a.field4 in (
            '1',
            '2',
            '3'
            ,'4'
        )
  fix_str: |
    SELECT
        a.foo
        
        -- another comment
        , a.baz
        -- another comment
         , a.bar
    
        -- This is an important comment with awkward line spacing
    
       , a.foobar
    
        /* Which might also
        be followed by a multiline one */
        , a.barfoo
    FROM a
    WHERE
        a.field4 in (
            '1'
            , '2'
            , '3'
            ,'4'
        )

  configs:
    rules:
      L019:
        comma_style: leading
