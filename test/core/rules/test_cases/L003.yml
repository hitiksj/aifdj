rule: L003

test_1:
  fail_str: '     SELECT 1'
  fix_str: SELECT 1

test_2:
  # Github Bug #99. Python2 Issues with fixing L003
  fail_str: '  select 1 from tbl;'
  fix_str: select 1 from tbl;

test_3:
  # Github Bug #203
  pass_str: |
    SELECT
        -- Compute the thing
        (a + b) AS c
    FROM
        acceptable_buckets

test_4:
  pass_str: |
    SELECT
        user_id
    FROM
        age_data
    JOIN
        audience_size
        USING (user_id, list_id)
    -- We LEFT JOIN because blah
    LEFT JOIN
        verts
        USING
            (user_id)

test_5:
  # Using tabs as indents works
  fail_str: |
    SELECT
    	a,
    b
    FROM my_tbl

  fix_str: |
    SELECT
    	a,
    	b
    FROM my_tbl

  configs:
    rules:
      indent_unit: tab

test_6:
  # Configurable indents work.
  # a) default
  pass_str: |
    SELECT a, b, c

    FROM my_tbl

    LEFT JOIN another_tbl USING(a)

test_7:
  # b) specific
  pass_str: |
    SELECT a, b, c

    FROM my_tbl

    LEFT JOIN another_tbl USING(a)

  configs:
    indentation:
      indented_joins: false

test_8:
  # c) specific True, but passing
  pass_str: |
    SELECT a, b, c
    FROM my_tbl
        LEFT JOIN another_tbl USING(a)

  configs:
    indentation:
      indented_joins: true

test_9:
  # d) specific True, but failing
  fail_str: |
    SELECT a, b, c
    FROM my_tbl
    LEFT JOIN another_tbl USING(a)

  fix_str: |
    SELECT a, b, c
    FROM my_tbl
        LEFT JOIN another_tbl USING(a)

  configs:
    indentation:
      indented_joins: true

test_10:
  # e) specific False, and failing
  fail_str: |
    SELECT a, b, c
    FROM my_tbl
        LEFT JOIN another_tbl USING(a)

  fix_str: |
    SELECT a, b, c
    FROM my_tbl
    LEFT JOIN another_tbl USING(a)

  configs:
    indentation:
      indented_joins: false

test_11:
  pass_str: |
    SELECT *
    FROM
        t1
    -- Comment
    JOIN t2 USING (user_id)

test_12:
  fail_str: |
    SELECT *
    FROM
        t1
        -- Comment
    JOIN t2 USING (user_id)

  fix_str: |
    SELECT *
    FROM
        t1
    -- Comment
    JOIN t2 USING (user_id)

test_13:
  # GitHub issue #318. Keep "DISTINCT" on the line with the "SELECT".
  fail_str: |
    SELECT
        DISTINCT user_id,
        list_id
    FROM
        safe_user
  fix_str: |
    SELECT    DISTINCT user_id,
        list_id
    FROM
        safe_user

test_14:
  # Same as test_13, but with a comment line in between SELECT and DISTINCT.
  fail_str: |
    SELECT
        -- The table contains duplicates, so use DISTINCT.
        DISTINCT user_id,
        list_id
    FROM
        safe_user
  fix_str: |
    SELECT DISTINCT
        -- The table contains duplicates, so use DISTINCT.
        user_id,
        list_id
    FROM
        safe_user
