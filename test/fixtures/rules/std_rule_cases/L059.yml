rule: L059

# Configuration test matrix
# Pass/Fail Forced  Preferred       Test
# Pass      False   Double quote    test_pass_column_reference
# Fail      False   Double quote    test_fail_column_reference
# Pass      False   Double quote    test_pass_table_reference
# Fail      False   Double quote    test_fail_table_reference
# Pass      False   Double quote    test_pass_multiple_references
# Fail      False   Double quote    test_fail_multiple_references
# Pass      False   Double quote    test_pass_whitespace
# Pass      False   Double quote    test_pass_special_symbols
# Pass      False   Double quote    test_pass_reserved_keyword
# Pass      False   Backtick        test_pass_column_reference_backtick
# Fail      False   Backtick        test_fail_column_reference_backtick
# Pass      False   Backtick        test_pass_table_reference_backtick
# Fail      False   Backtick        test_fail_table_reference_backtick
# Pass      False   Backtick        test_pass_multiple_references_backtick
# Fail      False   Backtick        test_fail_multiple_references_backtick
# Pass      False   Backtick        test_pass_whitespace_backtick
# Pass      False   Backtick        test_pass_special_symbols_backtick
# Pass      False   Backtick        test_pass_reserved_keyword_backtick
# Pass      False   Backtick        test_pass_ignored_as_contains_backtick
# Pass      True    Backtick        test_pass_column_reference_backtick_forced
# Fail      True    Backtick        test_fail_column_reference_backtick_forced
# Pass      True    Backtick        test_pass_table_reference_backtick_forced
# Fail      True    Backtick        test_fail_table_reference_backtick_forced
# Pass      True    Backtick        test_pass_multiple_references_backtick_forced
# Fail      True    Backtick        test_fail_multiple_references_backtick_forced
# Pass      True    Backtick        test_pass_whitespace_backtick_forced
# Pass      True    Backtick        test_pass_special_symbols_backtick_forced
# Pass      True    Backtick        test_pass_reserved_keyword_backtick_forced
# Pass      True    Backtick        test_pass_ignored_as_contains_backtick_forced

test_pass_column_reference:
  pass_str: |
    SELECT 123 AS foo;

test_fail_column_reference:
  fail_str: |
    SELECT 123 AS "foo";
  pass_str: |
    SELECT 123 AS foo;

test_pass_table_reference:
  pass_str: |
    SELECT foo
    FROM bar;

test_fail_table_reference:
  fail_str: |
    SELECT foo
    FROM "bar";
  fix_str: |
    SELECT foo
    FROM bar;

test_pass_multiple_references:
  pass_str: |
    SELECT foo
    FROM bar.baz;

test_fail_multiple_references:
  fail_str: |
    SELECT foo
    FROM "bar"."baz";
  fix_str: |
    SELECT foo
    FROM bar.baz;

test_pass_whitespace:
  pass_str: |
    SELECT 123 AS "I cannot be unquoted"

test_pass_special_symbols:
  pass_str: |
    SELECT 123 AS "I-c@nn0t-be~un-quoted"

test_pass_reserved_keyword:
  pass_str: |
    SELECT 123 AS "SELECT"

test_pass_column_reference_backtick:
  pass_str: |
    SELECT 123 AS foo;
  configs:
    rules:
      L059:
        preferred_quote_identifier: "`"

test_fail_column_reference_backtick:
  fail_str: |
    SELECT 123 AS "foo";
  pass_str: |
    SELECT 123 AS `foo`;
  configs:
    rules:
      L059:
        preferred_quote_identifier: "`"

test_pass_table_reference_backtick:
  pass_str: |
    SELECT foo
    FROM bar;
  configs:
    rules:
      L059:
        preferred_quote_identifier: "`"

test_fail_table_reference_backtick:
  fail_str: |
    SELECT foo
    FROM "bar";
  fix_str: |
    SELECT foo
    FROM `bar`;
  configs:
    rules:
      L059:
        preferred_quote_identifier: "`"

test_pass_multiple_references_backtick:
  pass_str: |
    SELECT foo
    FROM bar.baz;
  configs:
    rules:
      L059:
        preferred_quote_identifier: "`"

test_fail_multiple_references_backtick:
  fail_str: |
    SELECT foo
    FROM "bar"."baz";
  fix_str: |
    SELECT foo
    FROM `bar`.`baz`;
  configs:
    rules:
      L059:
        preferred_quote_identifier: "`"

test_pass_whitespace_backtick:
  pass_str: |
    SELECT 123 AS `I cannot be unquoted`
  configs:
    rules:
      L059:
        preferred_quote_identifier: "`"

test_pass_special_symbols_backtick:
  pass_str: |
    SELECT 123 AS `I-c@nn0t-be~un-quoted`
  configs:
    rules:
      L059:
        preferred_quote_identifier: "`"

test_pass_reserved_keyword_backtick:
  pass_str: |
    SELECT 123 AS `SELECT`
  configs:
    rules:
      L059:
        preferred_quote_identifier: "`"

test_pass_ignored_as_contains_backtick:
  pass_str: |
    SELECT 123 AS "Ignored`as`contains`backticks"
  configs:
    rules:
      L059:
        preferred_quote_identifier: "`"

test_pass_column_reference_backtick_forced:
  pass_str: |
    SELECT 123 AS `foo`;
  configs:
    rules:
      L059:
        force_quote_identifier: True
        preferred_quote_identifier: "`"

test_fail_column_reference_backtick_forced:
  fail_str: |
    SELECT 123 AS foo;
  pass_str: |
    SELECT 123 AS `foo`;
  configs:
    rules:
      L059:
        force_quote_identifier: True
        preferred_quote_identifier: "`"

test_pass_table_reference_backtick_forced:
  pass_str: |
    SELECT `foo`
    FROM `bar`;
  configs:
    rules:
      L059:
        force_quote_identifier: True
        preferred_quote_identifier: "`"

test_fail_table_reference_backtick_forced:
  fail_str: |
    SELECT `foo`
    FROM bar;
  fix_str: |
    SELECT `foo`
    FROM `bar`;
  configs:
    rules:
      L059:
        force_quote_identifier: True
        preferred_quote_identifier: "`"

test_pass_multiple_references_backtick_forced:
  pass_str: |
    SELECT `foo`
    FROM `bar`.`baz`;
  configs:
    rules:
      L059:
        force_quote_identifier: True
        preferred_quote_identifier: "`"

test_fail_multiple_references_backtick_forced:
  fail_str: |
    SELECT `foo`
    FROM bar.baz;
  fix_str: |
    SELECT `foo`
    FROM `bar`.`baz`;
  configs:
    rules:
      L059:
        force_quote_identifier: True
        preferred_quote_identifier: "`"

test_pass_whitespace_backtick_forced:
  pass_str: |
    SELECT 123 AS `I cannot be unquoted`
  configs:
    rules:
      L059:
        force_quote_identifier: True
        preferred_quote_identifier: "`"

test_pass_special_symbols_backtick_forced:
  pass_str: |
    SELECT 123 AS `I-c@nn0t-be~un-quoted`
  configs:
    rules:
      L059:
        force_quote_identifier: True
        preferred_quote_identifier: "`"

test_pass_reserved_keyword_backtick_forced:
  pass_str: |
    SELECT 123 AS `SELECT`
  configs:
    rules:
      L059:
        force_quote_identifier: True
        preferred_quote_identifier: "`"

test_pass_ignored_as_contains_backtick_forced:
  pass_str: |
    SELECT 123 AS "Ignored`as`contains`backticks"
  configs:
    rules:
      L059:
        force_quote_identifier: True
        preferred_quote_identifier: "`"
