rule: AL09

test_pass_no_alias:
    pass_str:
        select
            col_a,
            col_b
        from foo

test_pass_no_self_alias:
    pass_str:
        select
            col_a,
            col_b as new_col_b
        from foo

test_pass_no_self_alias_function:
    pass_str:
        select
            max(sum) as max_sum
        from foo

test_fail_self_alias:
    fail_str:
        select
            col_a as col_a,
            col_b as new_col_b
        from foo
    fix_str:
        select
            col_a,
            col_b as new_col_b
        from foo
    configs:
        core:
            dialect: postgres

test_fail_self_alias_upper:
    fail_str:
        select
            col_a as COL_A,
            col_b as new_col_b
        from foo
    fix_str:
        select
            col_a,
            col_b as new_col_b
        from foo

test_fail_self_alias_implicit:
    fail_str:
        select
            col_a col_a,
            col_b AS new_col_b
        from foo
    fix_str:
        select
            col_a,
            col_b AS new_col_b
        from foo
    configs:
        core:
            dialect: postgres

test_fail_self_alias_and_table_aliased:
    fail_str:
        select
            a.col_a as col_a,
            a.col_b as new_col_b
        from foo as a

    fix_str:
        select
            a.col_a,
            a.col_b as new_col_b
        from foo as a
    configs:
        core:
            dialect: postgres

test_fail_self_alias_quoted:
    fail_str:
        select
            "col_a" as "col_a",
            col_b as new_col_b
        from foo
    fix_str:
        select
            "col_a",
            col_b as new_col_b
        from foo

test_fail_self_alias_case_sensitive_column:
    # Renaming the column name from case-sensitive to case-insensitive
    fail_str:
        select
            "col_a" as col_a,
            col_b as new_col_b
        from foo
    fix_str:
        select
            "col_a",
            col_b as new_col_b
        from foo

test_pass_self_alias_case_sensitive:
    # Renaming the column name from case-insensitive to case-sensitive
    pass_str:
        select
            col_a as "col_a",
            col_b as new_col_b
        from foo

test_fail_tsql_case_sensitive_result_set:
    fail_str:
        SELECT
            id AS  ID,
            date AS Date,
            description AS Description
        FROM foo
    fix_str:
        SELECT
            ID,
            Date,
            Description
        FROM foo
    configs:
        core:
            dialect: tsql

test_pass_snowflake_case_sensitive:
    pass_str:
        SELECT "ORDER" as "order" FROM foo
    configs:
        core:
            dialect: snowflake

test_fail_bigquery_case_sensitive_result_set:
    fail_str:
        SELECT Employee_ID AS employee_id FROM foo
    fix_str:
        SELECT employee_id FROM foo
    configs:
        core:
            dialect: bigquery

test_fail_bigquery_case_sensitive_result_set_qualified:
    fail_str:
        SELECT a.Employee_ID AS employee_id FROM foo a
    fix_str:
        SELECT a.employee_id FROM foo a
    configs:
        core:
            dialect: bigquery

test_fail_clickhouse_different_case_6019:
    fail_str: |
        SELECT
            myidcol AS col_id,
            my_expected_drop_alias AS my_expected_drop_alias,
            My_Wrong_Case_Col as my_wrong_case_col,
            my_good_col,
        FROM
            file('myfile.parquet', 'Parquet')
    fix_str: |
        SELECT
            myidcol AS col_id,
            my_expected_drop_alias,
            My_Wrong_Case_Col as my_wrong_case_col,
            my_good_col,
        FROM
            file('myfile.parquet', 'Parquet')
    configs:
        core:
            dialect: clickhouse
